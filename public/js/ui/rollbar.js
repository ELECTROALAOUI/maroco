define("js/ui/rollbar",["mousewheel"],function(t,s,i){function e(t,s){if(!$(t).find(">.rollbar-content").length){var i=this,e=_.uniqueId("rollbar");this.namespace="."+e,this.container=$(t),this.settings=s,this.timer=0,this.top=0,this.left=0,this.before={v:0,h:0},this.touch={},this.pressed=0,this.vslider=$("<div/>",{"class":"rollbar-handle",style:"top:"+s.pathPadding+"px"}),this.vpath=$("<div/>",{"class":"rollbar-path-vertical"}),this.hslider=$("<div/>",{"class":"rollbar-handle",style:"left:"+s.pathPadding+"px"}),this.hpath=$("<div/>",{"class":"rollbar-path-horizontal"}),this.sliders=this.vslider.add(this.hslider),"absolute"!==this.container.css("position")&&this.container.css("position","relative"),this.container.css({overflow:"hidden"}).wrapInner('<div class="rollbar-content" id="'+e+'"></div>'),this.content=this.container.children(".rollbar-content").css({position:"relative",top:0,left:0}),"horizontal"==s.scroll?this.container.prepend(this.hpath.append(this.hslider)):"vertical"==s.scroll?this.container.prepend(this.vpath.append(this.vslider)):this.container.prepend(this.vpath.append(this.vslider),this.hpath.append(this.hslider)),this.vpath.add(this.hpath).css({"z-index":s.zIndex,display:"none"}),this.vslider.css({height:s.sliderSize,opacity:s.sliderOpacity}),this.hslider.css({width:s.sliderSize,opacity:s.sliderOpacity}),s.shadow&&(this.shadow=$('<div class="rollbar-shadow">').hide().appendTo(this.container)),this.init(),this.checkScroll();var o,n=function(){return document.getElementById(e)?void i.checkScroll():(clearInterval(o),$(document).off(i.namespace),$(window).off("resize",n),i.container.off(i.namespace),i.container=null,void $("body").removeClass("rollbar-noselect"))};s.checkTimer?o=setInterval(n,s.checkTimer):$(window).on("resize",n=_.throttle(n,100,{leading:!1}))}}t("mousewheel"),e.prototype.checkScroll=function(){var t=this.content.height(),s=this.container.height(),i=this.content[0].scrollWidth,e=this.container.width(),o=t-s,n=i-e,h=this.settings.pathPadding;0>o&&(o=0),0>n&&(n=0),o!=this.vdiff&&(this.vpath.toggle(o>0),0>=o?(this.top=0,this.content.css("top",this.top=0)):-this.top>o&&this.content.css("top",this.top=-o),this.vdiff=o,this.vslider.height(100*s/t+"%")),o>0&&(this.vtrack=s-2*h-this.vslider.height()),n!=this.hdiff&&(this.hpath.toggle(n>0),0>=n?(this.left=0,this.content.css("left",this.left=0)):-this.left>n&&this.content.css("left",this.left=-n),this.hdiff=n,this.hslider.width(100*e/i+"%")),n>0&&(this.htrack=e-2*h-this.hslider.width())},e.prototype.scroll=function(t,s,i,e){var o=this.settings.pathPadding;0>t&&(t=0),t>this.vdiff&&(t=this.vdiff),this.top!==-t&&(this.content.css("top",this.top=-t),this.vdiff>0&&(this.vslider.css("top",Math.round(t/this.vdiff*this.vtrack)+o),e&&t&&t!=this.vdiff&&(e.stopPropagation(),e.preventDefault()),this.shadow&&this.shadow.toggle(t>0))),0>s&&(s=0),s>this.hdiff&&(s=this.hdiff),this.left!==-s&&(this.content.css("left",this.left=-s),this.hdiff>0&&(this.hslider.css("left",Math.round(s/this.hdiff*this.htrack)+o),e&&s&&s!=this.hdiff&&(e.stopPropagation(),e.preventDefault()))),(this.before.v!=t||this.before.h!=s)&&(i||this.settings.onscroll.call(this.container,t,s),this.before.v=t,this.before.h=s)},e.prototype.init=function(){var t=$(document),s=this,i=$("body");this.sliders.on("mousedown"+this.namespace,function(e){s.pressed=e.target===s.vslider.get(0)?1:2;var o=e.pageX,n=e.pageY,h=-s.top,a=-s.left,l=s.vdiff/s.vtrack,r=s.hdiff/s.htrack;i.addClass("rollbar-noselect"),t.on("mousemove"+s.namespace,function(t){1==s.pressed?s.scroll(h+(t.pageY-n)*l,a):s.scroll(h,a+(t.pageX-o)*r)}).on("selectstart"+this.namespace,function(t){t.preventDefault()})}),t.on("mouseup"+this.namespace,function(e){s.pressed=0,t.off("mousemove"+s.namespace),t.off("selectstart"+s.namespace),i.removeClass("rollbar-noselect")}),this.container.on("keydown"+this.namespace,function(t){var i=t.keyCode;9==i&&setTimeout(function(){s.container.scrollTop(0).scrollLeft(0)});var e=0,o=0,n=s.settings.scrollamount;o=38==i?-n:o,o=40==i?n:o,e=37==i?-n:e,e=39==i?n:e,(o||e)&&s.scroll(-s.top+o,-s.left+e)}).on("touchstart"+this.namespace,function(t){var i=t.originalEvent,e=i.changedTouches[0];s.touch.sx=e.pageX,s.touch.sy=e.pageY,s.touch.sv=s.vslider.position().top,s.touch.sh=s.hslider.position().left,s.settings.blockGlobalScroll&&(s.vdiff||s.hdiff)&&i.stopPropagation()}).on("touchmove"+this.namespace,function(t){var i=t.originalEvent,e=i.targetTouches[0];s.scroll(s.touch.sv+(s.touch.sy-e.pageY)*s.settings.touchSpeed,s.touch.sh+(s.touch.sx-e.pageX)*s.settings.touchSpeed,t),s.settings.blockGlobalScroll&&(s.vdiff||s.hdiff)&&(i.preventDefault(),i.stopPropagation())}).on("touchend"+this.namespace+" touchcancel"+this.namespace,function(t){var i=t.originalEvent;i.changedTouches[0];s.settings.blockGlobalScroll&&(s.vdiff||s.hdiff)&&i.stopPropagation()}).on("mousewheel"+this.namespace,function(t,i,e,o){var n=t.target.nodeName;return"TEXTAREA"==n||"SELECT"==n||"OPTION"==n?void t.stopPropagation():((s.vdiff>0||s.hdiff>0)&&s.scroll(-s.top-o*s.settings.scrollamount,-s.left-e*s.settings.scrollamount,0,t),void(s.settings.blockGlobalScroll&&(s.vdiff||s.hdiff)&&(t.preventDefault(),t.stopPropagation())))}).on("dragstart"+this.namespace,function(t){t.preventDefault()}).on("rollbar"+this.namespace,function(t,i,e,o){t.stopPropagation(),void 0===i?s.checkScroll():(i=$.isNumeric(i)?i:-this.top,e=$.isNumeric(e)?e:-this.left,s.scroll(i,e,o))}).on("mouseenter"+this.namespace,function(){s.sliders.css("opacity",s.settings.sliderOpacity)}).on("mouseleave"+this.namespace,function(){s.sliders.css("opacity",.05)})};var o={scroll:"both",checkTimer:500,blockGlobalScroll:!1,sliderSize:"30%",sliderOpacity:.3,scrollamount:100,touchSpeed:.3,pathPadding:3,zIndex:100,onscroll:$.noop};$.fn.rollbar=function(t){return t=_.create(o,t),this.each(function(){new e(this,t)})}});